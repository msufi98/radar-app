<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NEXRAD Level 2 Radar Data Viewer - Interactive map-based radar site and data selection">
    <title>NEXRAD Radar Viewer</title>
</head>
<body>
    <!-- Full-screen Map Container -->
    <div id="map" role="application" aria-label="Interactive map of NEXRAD radar sites"></div>

    <!-- Header -->
    <header class="app-header">
        <h1 class="app-title">NEXRAD Level 2 Radar Viewer</h1>
    </header>

    <!-- Site Search Panel (Floating Top-Left) -->
    <aside class="panel panel--search" aria-label="Radar site search">
        <div class="panel__content">
            <div class="search-header">
                <label for="siteSearch" class="panel__label">Search Radar Sites</label>
                <button
                    id="resetBtn"
                    class="btn btn--reset"
                    title="Reset all filters and selections"
                    aria-label="Reset all filters and selections"
                >
                    Reset
                </button>
            </div>
            <input
                type="text"
                id="siteSearch"
                class="input input--search"
                placeholder="Search by code, name, or state..."
                aria-describedby="searchHelp"
            >
            <div id="selectedSite" class="site-selection" role="status" aria-live="polite"></div>
        </div>
    </aside>

    <!-- Reflectivity Legend (Floating Bottom-Left) -->
    <aside id="reflectivityLegend" class="legend" style="display: none;" aria-label="Reflectivity scale legend">
        <div class="legend__content">
            <h3 class="legend__title">Reflectivity (dBZ)</h3>
            <div class="legend__scale-container">
                <canvas id="legendCanvas" class="legend__canvas"></canvas>
                <svg id="legendTicks" class="legend__ticks"></svg>
            </div>
            <div class="legend__labels">
                <span class="legend__label legend__label--min" id="legendMin"></span>
                <span class="legend__label legend__label--mid" id="legendMid"></span>
                <span class="legend__label legend__label--max" id="legendMax"></span>
            </div>
        </div>
    </aside>

    <!-- Date & Time Selection Panel (Floating Right) -->
    <aside class="panel panel--datetime" aria-label="Date and time selection">
        <div class="panel__content">

            <!-- Accordion: Step 1 - Select Date & Time -->
            <div class="accordion-section" data-step="1">
                <button class="accordion-header" id="step1Header" aria-expanded="true">
                    <span class="accordion-header__title">
                        <span class="accordion-header__step">Step 1:</span>
                        <span class="accordion-header__text">Select Date & Time</span>
                    </span>
                    <span class="accordion-header__icon">▲</span>
                </button>

                <div class="accordion-content" id="step1Content">
                    <!-- Date Selectors -->
                    <div id="dateTimeControls" class="date-selectors">
                        <div class="input-group">
                            <label for="yearSelect" class="input-group__label">Year</label>
                            <select id="yearSelect" class="select" aria-required="true">
                                <option value="">Select Year</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="monthSelect" class="input-group__label">Month</label>
                            <select id="monthSelect" class="select" disabled aria-required="true">
                                <option value="">Select Month</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="daySelect" class="input-group__label">Day</label>
                            <select id="daySelect" class="select" disabled aria-required="true">
                                <option value="">Select Day</option>
                            </select>
                        </div>
                    </div>

                    <!-- Status Messages -->
                    <div id="dataStatus" class="status-message" role="alert" aria-live="polite"></div>

                    <!-- Time Selector -->
                    <section id="timeSelector" class="time-selector" style="display: none;" aria-label="Available scan times">
                        <h3 class="time-selector__heading">Available Times (Click to Load)</h3>
                        <div id="timesList" class="times-grid"></div>
                    </section>
                </div>
            </div>

            <!-- Accordion: Step 2 - Radar Display -->
            <div class="accordion-section" data-step="2">
                <button class="accordion-header" id="step2Header" aria-expanded="false">
                    <span class="accordion-header__title">
                        <span class="accordion-header__step">Step 2:</span>
                        <span class="accordion-header__text">Radar Display</span>
                    </span>
                    <span class="accordion-header__icon">▼</span>
                </button>

                <div class="accordion-content" id="step2Content" style="display: none;">
                    <!-- Radar Status Messages -->
                    <div id="radarStatus" class="status-message" role="alert" aria-live="polite"></div>

                    <div id="radarControls">
                        <div class="input-group">
                            <label for="resolutionSelect" class="input-group__label">Resolution</label>
                            <select id="resolutionSelect" class="select">
                                <option value="">Select Resolution</option>
                                <option value="auto">Auto (All Scans)</option>
                                <option value="360">Low Resolution (360 radials)</option>
                                <option value="720">High Resolution (720 radials)</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="scanLevelSelect" class="input-group__label">Scan Level (Elevation) - Select to Display</label>
                            <select id="scanLevelSelect" class="select" disabled>
                                <option value="">Select Resolution First</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accordion: Step 3 - Precipitation Data -->
            <div class="accordion-section" data-step="3">
                <button class="accordion-header" id="step3Header" aria-expanded="false">
                    <span class="accordion-header__title">
                        <span class="accordion-header__step">Step 3:</span>
                        <span class="accordion-header__text">Precipitation Data</span>
                    </span>
                    <span class="accordion-header__icon">▼</span>
                </button>

                <div class="accordion-content" id="step3Content" style="display: none;">
                    <div class="zoom-controls">
                        <div class="input-group">
                            <label for="zoomPercentage" class="input-group__label">Zoom Area (% of radar circle)</label>
                            <div class="zoom-percentage-display">
                                <span id="zoomPercentageValue">4</span>%
                            </div>
                            <div class="zoom-hint">Use mouse wheel to adjust (2-10%)</div>
                        </div>
                    </div>

                    <div id="precipitationStatus" class="status-message info" style="display: block;">
                        <span class="info-icon">ℹ</span> Hover over the radar area to view detailed precipitation data
                    </div>
                </div>
            </div>

        </div>
    </aside>

    <!-- Zoom Window (Top-Right Corner) -->
    <aside id="zoomWindow" class="zoom-window" style="display: none;" aria-label="Detailed precipitation view">
        <div class="zoom-window__header">
            <h3 class="zoom-window__title">Detail View</h3>
            <div class="zoom-window__coords" id="zoomCoords"></div>
        </div>
        <div class="zoom-window__canvas-container">
            <canvas id="zoomCanvas" class="zoom-window__canvas"></canvas>
        </div>
    </aside>

    <!-- Google Maps API Loader -->
    <script>
        (g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
            key: "AIzaSyA5Lz7efVijEPENVUhJBIPY_718UehmL_U",
            v: "beta"
        });
    </script>
</body>
</html>